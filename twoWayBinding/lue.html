<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <div id='app'>
        <input type='text' id='input' v-model='text'>
        <button v-click='increment'>increment</button>
        {{text}}
    </div>
    <script>

        function Lue(options){
            this._init(options);
            
        }
        Lue.prototype._init=function(options){
            this.$options=options;                              //传入的实例配置
            this.$el=document.querySelector(options.el);        //实例绑定的根节点
            this.$data=options.data;                            //实例的数据域
            this.$methods=options.methods;                      //实例的函数域
            this._parseData(this.$data)
        };
        Lue.prototype.defineReactive=function(key,val){
            Object.defineProperty(this.$data, key,{
                enumerable:true,
                configurable:true,
                get:function(){
                    console.log(`获取${val}`)
                    return val;
                },
                set:function(newVal){
                    console.log(`更新${newVal}`)
                    val=newVal;
                }
            })
        };
        Lue.prototype._parseData = function(obj) {
            const vm = this
            Object.keys(obj).forEach(function(key){
                vm.defineReactive(key, obj[key])
            })
        }

        Lue.prototype._parseFunc = function(attrVal) {
            var args=/\(.*\)/.exec(attrVal)
            console.log(args)
            if(args) {
                args = args[0]
                attrVal = attrVal.replace(args,'') //取出函数名称
                args = args.replace(/[\(\)\'\"]/g,'').split(',') //取出函数参数数组
            } else {
                args = []
            }
            return this.$methods[attrVal].bind(this.$data, args)
        }

        var app=new Lue({
            el:"#app",
            data:{
                count:0,
            },
            methods:{
                increment:function(){
                    this.count++;
                }
            }
        })
    </script>
</body>
</html>